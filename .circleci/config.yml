version: 2.1

setup: true  # Habilita pipelines de configuración dinámica

orbs:
  continuation: circleci/continuation@0.1.2  # Orb para continuar pipelines dinámicos

workflows:
  setup:
    jobs:
      - trigger_pipeline:
          name: Seleccionar Pipeline
          pipeline_config: config1.yml  # Valor por defecto
          filters:
            branches:
              only: main

jobs:
  trigger_pipeline:
    docker:
      - image: cimg/python:3.9
    parameters:
      pipeline_config:
        type: string
        default: config1.yml
    steps:
      - checkout
      - run:
          name: Ejecutar Pipeline Seleccionado
          command: |
            echo "Ejecutando el pipeline: << parameters.pipeline_config >>"
            circleci pipeline trigger -c .circleci/<< parameters.pipeline_config >>
